@using ProjectChapeau.Models;
@using ProjectChapeau.Models.Enums;
@using ProjectChapeau.Models.ViewModel;

@model List<TableWithOrder>

<div class="container py-4">
    <div class="row g-4 justify-content-center">
        @foreach (TableWithOrder tableWithOrder in Model)
        {
            string cardColor = "bg-success text-white";
            string statusText = "Available";

            if (tableWithOrder.Order?.OrderId != null && tableWithOrder.Order.OrderStatus != OrderStatus.Completed)
            {
                cardColor = tableWithOrder.Table.IsOccupied ? "bg-danger text-dark" : "bg-warning text-dark";
                statusText = $"Order {tableWithOrder.Order.OrderStatus}";
            }
            else if (tableWithOrder.Table.IsOccupied)
            {
                cardColor = "bg-warning text-dark";
                statusText = "Occupied";
            }

            <div class="col-12 col-md-6 d-flex justify-content-center">
                <a href="/Tables/Edit/@tableWithOrder.Table.TableNumber" style="text-decoration: none; width:100%;">
                    <div class="card shadow rounded-3 border-0 @cardColor d-flex flex-column justify-content-center align-items-center text-center"
                         style="min-height: 200px; max-width: 320px; margin: 0 auto;">
                        <i class="bi bi-clock-history fs-2 mb-2" style="color: #222;"></i>
                        <div class="fs-4 mb-1">Table: @tableWithOrder.Table.TableNumber</div>
                        <div class="fs-6 text-break">
                            Status:
                            <span class="fw-semibold">
                                <span class="fw-bold">@statusText</span>
                            </span>
                        </div>
                    </div>
                </a>
            </div>
        }
    </div>
</div>       