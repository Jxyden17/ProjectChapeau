@using ProjectChapeau.Models.Enums
@model ProjectChapeau.Views.ViewModel.TableOrderModel


@foreach (RestaurantTable table in Model.restaurantTables)
{
    Order latestOrder = Model.Orders.Where(o => o.tableId.TableNumber == table.TableNumber).OrderByDescending(o => o.datetime).FirstOrDefault();

    string cardColor = "bg-success text-white";
    string statusText = "Available";

    if (latestOrder != null && latestOrder.orderStatus != OrderStatus.Completed)
    {
        cardColor = "bg-warning text-dark";
        statusText = $"Order {latestOrder.orderStatus}";
    }

    <div class="col-md-3 mb-4">
        <div class="card h-100 shadow-sm border-0 @cardColor">
            <div class="card-body text-center">
                <h5 class="card-title">Table @table.TableNumber</h5>
                <p class="card-text">Status: <strong>@statusText</strong></p>
            </div>
        </div>
    </div>
}